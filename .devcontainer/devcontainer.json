{
	"name": "flowpipe-devcontainer",
	"image": "ghcr.io/turbot/flowpipe-devcontainer:2.5.0",

	"containerEnv": {
		"GOPRIVATE=github.com/": "github.com/turbot/*"
	},

	"mounts": [
		"source=${localWorkspaceFolder}/../pipe-fittings,target=/workspaces/pipe-fittings,type=bind,consistency=cached",
		"source=${localWorkspaceFolder}/../flowpipe-sdk-go,target=/workspaces/flowpipe-sdk-go,type=bind,consistency=cached",
		// This has been added to improve build performace between dev container restarts
		"source=flowpipe-go-bin-volume,target=/go/bin,type=volume",
		"source=flowpipe-go-pkg-volume,target=/go/pkg,type=volume",
		"source=flowpipe-go-build-cache,target=/root/.cache/go-build,type=volume"
		// Optionally, include the src if developing inside the container
		// "source=flowpipe-go-src-volume,target=/go/src,type=volume"
	],

	"features": {
		"ghcr.io/devcontainers/features/docker-in-docker:2": {}
	},

	// Automatically remove the container when it is stopped (docker rm <container-name>)
	// not reliable: https://github.com/microsoft/vscode-remote-release/issues/3512
	"runArgs": ["--rm"],

	"customizations": {
		// Configure properties specific to VS Code.
		"vscode": {
		  // Add the IDs of extensions you want installed when the container is created.
		  "extensions": [
			"github.copilot",
			"eamodio.gitlens",
			"ms-azuretools.vscode-docker",
			"ms-vscode.makefile-tools",
			"hashicorp.terraform",
			"GitHub.vscode-github-actions",
			"HashiCorp.HCL"]
		}
	},

	"postStartCommand": ".devcontainer/scripts/post-start-command.sh"
}
